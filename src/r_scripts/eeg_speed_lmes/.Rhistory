# ERROR. png() device not found bug try: dev.off()
# ERROR. png() device not found fixed by changing cell names to a simple "windows friendlY" format so that knitr could save files.
knitr::opts_chunk$set(echo = TRUE)
# install.packages(c("tidyverse","purrr","R.matlab","readxl","dplyr"))
#%% PACKAGES FOR STATS
library(readxl);
library(purrr);
library(tidyverse);
library(tibble);
library(knitr);
library(gtsummary);
library(kableExtra);
library(lme4);
library(MuMIn);
library(car);
library(effectsize)
library(sjPlot);
#%% PACKAGES FOR PLOTS & HTML HANDLING
# library(effects);
# library(sjPlot);
# library(plotly);
# library(webshot)
# library(reshape2);
# library(htmltools)
# library(Polychrome);
# library(htmlwidgets);
# library(shiny)
# library(webshot)
library(scatterplot3d)
library(RColorBrewer)
library(openxlsx)
gtsummary::set_gtsummary_theme(theme_gtsummary_journal("jama"))
#--
ispc <- function() {
sys_name <- Sys.info()["sysname"]
if (sys_name == "Windows") {
return(TRUE)
} else {
return(FALSE)
}
}
#%% CLUSTERS TO PLOT
# clusters = c(3,4,6,7,8,9,10,13) # 10172024_MIM_YAOAN89_antsnorm_dipfix_iccREMG0p4_powpow0p3_skull0p01_15mmrej_speed
# clusters = c(3,4,5,7,10,12,13) # RSup/RSM, PreC, LSM, Mid Cing, LSup, LPPA, RPPA
clusters = c(3,4,5,6,7,8,12)
#%% EEG PARAMS
#--
eeg_measures = c('theta_avg_power','alpha_avg_power','beta_avg_power');
eeg_title_chars = c("**THETA** Mean","**ALPHA** Mean","**BETA** Mean",);
excel_dir <- paste0("/jsalminen/GitHub/MIND_IN_MOTION_PRJ/MindInMotion_YoungerOlderAdults_BrainSpeedChanges/src/r_scripts/eeg_speed_lmes/fooof_spec_table.xlsx")
if(ispc()){
excel_dir <- paste0("M:",excel_dir)
}else{
excel_dir <- paste0("/blue/dferris",excel_dir);
}
orig_eegt <- read_excel(excel_dir,sheet="Sheet1")
#%% SUBSET
#%% SUBSET
orig_eegt <- orig_eegt %>%
select(subj_char,cond_char,group_id,group_char,cluster_id,design_id,
avg_theta_power,avg_alpha_power,avg_beta_power,
);
#%% SUBSET
#%% SUBSET
orig_eegt <- orig_eegt %>%
select(subj_char,cond_char,group_id,group_char,cluster_id,design_id,
theta_avg_power,alpha_avg_power,beta_avg_power,
);
eegt <- orig_eegt;
eegt$group_name = eegt$group_char
eegt$model_char = eegt$design_id
eegt$cluster_n = eegt$cluster_id;
eegt <- filter_at(eegt,vars('cond_char'), any_vars(. %in% c('0p25','0p5','0p75','1p0')))
flat_speeds = unique(eegt$cond_char)
#%% MUTATE VARIABLES
eegt$speed_cond_num <- as.numeric(eegt$cond_char);
eegt <- mutate(eegt,across(c('subj_char'), factor))
eegt <- mutate(eegt,across(c('group_char'), factor))
eegt <- mutate(eegt,across(c('group_name'), factor))
eegt <- mutate(eegt,across(c('model_char'), factor))
#%% COLORS
color_pal_subj = brewer.pal(9,'PuBuGn')
color_pal_subj = color_pal_subj[5:9];
#%% TBL VALUES
tbl_clusterS = unique(eegt$cluster_n);
tbl_subjects = unique(eegt$subj_char);
tbl_groups = unique(eegt$group_char);
#%% DISPLAY TBL
head(eegt)
dtbl <- eegt;
rm(eegt)
eegt <- orig_eegt;
eegt$group_name = eegt$group_char
eegt$model_char = eegt$design_id
eegt$cluster_n = eegt$cluster_id;
eegt <- orig_eegt;
eegt$group_name = eegt$group_char
eegt$model_char = eegt$design_id
eegt$cluster_n = eegt$cluster_id;
eegt <- filter_at(eegt,vars('cond_char'), any_vars(. %in% c('0p25','0p5','0p75','1p0')))
flat_speeds = unique(eegt$cond_char)
#%% MUTATE VARIABLES
eegt$speed_cond_num <- as.numeric(eegt$cond_char);
eegt <- mutate(eegt,across(c('subj_char'), factor))
eegt <- mutate(eegt,across(c('group_char'), factor))
eegt <- mutate(eegt,across(c('group_name'), factor))
eegt <- mutate(eegt,across(c('model_char'), factor))
#%% COLORS
color_pal_subj = brewer.pal(9,'PuBuGn')
color_pal_subj = color_pal_subj[5:9];
#%% TBL VALUES
tbl_clusterS = unique(eegt$cluster_n);
tbl_subjects = unique(eegt$subj_char);
tbl_groups = unique(eegt$group_char);
eegt <- orig_eegt;
eegt$group_name = eegt$group_char
eegt$model_char = eegt$design_id
eegt$cluster_n = eegt$cluster_id;
eegt <- filter_at(eegt,vars('cond_char'), any_vars(. %in% c('0p25','0p5','0p75','1p0')))
flat_speeds = unique(eegt$cond_char)
#%% MUTATE VARIABLES
eegt$speed_cond_num <- as.numeric(eegt$cond_char);
eegt <- mutate(eegt,across(c('subj_char'), factor))
eegt <- mutate(eegt,across(c('group_char'), factor))
eegt <- mutate(eegt,across(c('group_name'), factor))
eegt <- mutate(eegt,across(c('model_char'), factor))
eegt <- orig_eegt;
eegt$group_name = eegt$group_char
eegt$model_char = eegt$design_id
eegt$cluster_n = eegt$cluster_id;
eegt <- filter_at(eegt,vars('cond_char'), any_vars(. %in% c('0p25','0p5','0p75','1p0')))
flat_speeds = unique(eegt$cond_char)
eegt$cond_char
orig_eegt$cond_char
unique(orig_eegt$cond_char)
eegt <- orig_eegt;
eegt$group_name = eegt$group_char
eegt$model_char = eegt$design_id
eegt$cluster_n = eegt$cluster_id;
eegt <- filter_at(eegt,vars('cond_char'), any_vars(. %in% c('0.25','0.5','0.75','1.0')))
flat_speeds = unique(eegt$cond_char)
#%% MUTATE VARIABLES
eegt$speed_cond_num <- as.numeric(eegt$cond_char);
eegt <- mutate(eegt,across(c('subj_char'), factor))
eegt <- mutate(eegt,across(c('group_char'), factor))
eegt <- mutate(eegt,across(c('group_name'), factor))
eegt <- mutate(eegt,across(c('model_char'), factor))
#%% COLORS
color_pal_subj = brewer.pal(9,'PuBuGn')
color_pal_subj = color_pal_subj[5:9];
#%% TBL VALUES
tbl_clusterS = unique(eegt$cluster_n);
tbl_subjects = unique(eegt$subj_char);
tbl_groups = unique(eegt$group_char);
#%% DISPLAY TBL
head(eegt)
dtbl <- eegt;
rm(eegt)
